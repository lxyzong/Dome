<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>智能评估</title>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
		<link rel="stylesheet" href="../static/css/common/reset.min.css?v=20180120" />
		<link rel="stylesheet" href="../static/css/phone_condition.css?v=201807133" />
	</head>

	<body>
		<div>
			<div class="title-msg" id="phone">
				<img src="../static/img/iPhone@2x.png" />
				<p>回收设备</p>
				<p class="phoneName">
					<span v-text="phoneName"></span> ,
					<span v-text="phoneMemory"></span>G
				</p>
				<p class="recycle">回收价</p>
				<div class="money">
					<span>¥</span>
					<span v-text="phoneValue"></span>
				</div>
				<p class="p">此价格为平台预估价，最终以质检价为准</p>
			</div>
			<div class="user-operation">
				<div class="forward">
					<p>卖了，不再使用</p>
					<p>（敬请期待）</p>
				</div>
				<button onclick="getPriceFromBusiness()">卖了，继续使用</button>
			</div>

			<div class="popup" id="popup">
				<div class="route">
					<svg version="1.1" id="L2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
						<circle fill="none" stroke="#cccccc" stroke-width="4" stroke-miterlimit="10" cx="50" cy="50" r="48" />
						<line fill="none" stroke-linecap="round" stroke="#cccccc" stroke-width="4" stroke-miterlimit="10" x1="50" y1="50" x2="85" y2="50.5">
							<animateTransform attributeName="transform" dur="2s" type="rotate" from="0 50 50" to="360 50 50" repeatCount="indefinite" />
						</line>
						<line fill="none" stroke-linecap="round" stroke="#cccccc" stroke-width="4" stroke-miterlimit="10" x1="50" y1="50" x2="49.5" y2="74">
							<animateTransform attributeName="transform" dur="15s" type="rotate" from="0 50 50" to="360 50 50" repeatCount="indefinite" />
						</line>
					</svg>
					<p>系统正在智能评估中...</p>
					<div class="wrap__uc-waves">
						<i class="wave w1"></i>
					</div>
				</div>
			</div>
		</div>
	</body>

</html>
<script src="../static/js/common.js?v=20180121"></script>
<script src="../static/js/common/axios.js"></script>
<script src="../static/js/bridge.js?v=20180120"></script>
<script type="text/javascript" src="../static/js/common/vue.min.js"></script>
<script>
	function reSelect() {
		history.go(-1);
	}
	var deviceMes = getDevice();
	//	var deviceMes = "malidai|iPhone7,2|32||";
	var arr = deviceMes.split('|'); //截取原生字段
	axios({
		baseURL: apiDomain(),
		url: 'phone/phone_search',
		method: 'POST',
		headers: {
			'content-type': 'application/x-www-form-urlencoded'
		},
		params: {
			version: "1.0.0",
			type: getClientType(),
			alias: arr[0],
			model: arr[1],
			memory: arr[2]
		},
	}).then(function(response) {
		var result = response.data;
		setTimeout(function() {
			document.getElementById("popup").style.display = "none";
			if(result.status == 2000) {
				new Vue({
					el: '#phone',
					data: function() {
						return {
							phoneValue: changeTwoDecimal(result.data.phoneWorth),
							phoneName: arr[1],
							phoneMemory: arr[2]
						}
					}
				})
			}
		}, 3000);

	}).catch(function(error) {
		console.log(error);
	})

	function getPriceFromBusiness() {
		var token = getToken();
		axios({
			baseURL: apiDomain(),
			url: 'user_ident_info',
			method: 'POST',
			headers: {
				'content-type': 'application/x-www-form-urlencoded'
			},
			params: {
				token: token
			},
		}).then(function(reuslt) {
			if(reuslt.data.status == 4002) {
				closeAndOpen(1);
				return
			}
			var page = '';
			if(reuslt.data.status == 2000) {
				var data = reuslt.data.data;
				if(data.realName != 2 || data.userDetails != 2 || data.mobile != 2 || data.liveness != 2 || data.alipay != 2) { //基础认证未全部完成
					page = webDomain() + '/user/cert_center.html';
				} else {
					if(data.bindbank != 2) {
						page = webDomain() + '/user/bank_card.html';
					} else {
						page = webDomain() + '/order/order_apply.html';
					}
				}
			}
			skipPage(0, page);
		}).catch(function(error) {
			console.log(error);
		});
	}
</script>