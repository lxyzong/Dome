<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>回购验证码</title>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<script src="../static/js/common.js?v=20180421"></script>
		<link rel="stylesheet" href="../static/css/common/reset.min.css?v=2222" />
		<link rel="stylesheet" href="../static/css/common/mui.min.css" />
		<link rel="stylesheet" href="../static/css/bank_card_code.css?v=1111" />

		<body>
			<ul>
				<li>
					<span>回购金额</span>
					<span id="repayMoney"></span>
				</li>

				<li>
					<span>手机号验证码</span>
					<span><input placeholder="请输入验证码" type="text" id="validateCode" /></span>
				</li>
			</ul>
			<div class="bind-card">
				<input type="button" value="确认回购" onclick="repay_active()" />
			</div>
			<div id="myModal" style="display:none">
				<img src="../static/img/loading.png">
			</div>
			<script src="../static/js/common/jquery.min.js"></script>
			<script src="../static/js/common/mui.min.js"></script>
			<script src="../static/js/bridge.js?v=20180424"></script>
			<script>
				var api_url = apiDomain();
				var token = getToken(1);

				function repay_active() {
					var validateCode = $("#validateCode").val();
					if(!validateCode) {
						mui.alert("请输入回购验证码");
						return
					}
					$.ajax({
						url: api_url + "order/repay_active",
						type: "post",
						dataType: "json",
						data: {
							token: token,
							repayNo: request['repayNo'],
							validateCode: validateCode
						},
						beforeSend: function() {
							$('#myModal').show();
						},
						success: function(data) {
							if(data.status == 2000) {
								skipPage(1, webDomain() + "order/pay_return.html?orderId=" + data.data);
							} else {
								mui.alert(data.message);
							}
						},
						complete: function() {
							$('#myModal').stop().hide();
						}
					});
				}
				$.ajax({
					url: api_url + "order/repay_info",
					type: "post",
					dataType: "json",
					data: {
						token: token,
						repayNo: request['repayNo']
					},
					success: function(data) {
						if(data.status == 2000) {
							$("#repayMoney").text(data.data.repayMoney);
						}
					}
				});
			</script>
		</body>

</html>